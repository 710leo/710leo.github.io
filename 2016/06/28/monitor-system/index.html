<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 企业级监控系统设计实践（1） · AsuraQin</title><meta name="description" content="企业级监控系统设计实践（1） - qinyening"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/710x710" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/710leo" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">企业级监控系统设计实践（1）</h1><div class="post-info">Jun 28, 2016</div><div class="post-content"><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>从公司产品上线的那一天就开始需要运维，而监控则是运维中重要的一环，那我们想一下，为什么要监控呢，因为要保证线上服务出问题之后或者即将出问题时能立刻感知，此外有些数据我们想知道它的发展趋势。这其实已经道出了监控的最小功能点：<br><strong>收集信息，进行处理，发出提醒，数据展示</strong></p>
<h3 id="阶段一："><a href="#阶段一：" class="headerlink" title="阶段一："></a>阶段一：</h3><p>机器数量：n &lt; 5<br>假如公司的只有一款产品部署在一台机器，那我们只要写一个监控脚本，收集机器的信息和业务指标，再加一些判断，就完事了<br><a id="more"></a></p>
<h3 id="阶段二："><a href="#阶段二：" class="headerlink" title="阶段二："></a>阶段二：</h3><p>机器数量：5 &lt; n &lt; 200<br>那如果公司规模扩大，机器增加到50台，项目组件分别部署在不同的机器。如果还按照原来的办法，每个机器的脚本各不相同，管理起来必然非常麻烦，之前脚本的方式显然不适用了。那怎么做呢。</p>
<ol>
<li>自己开发一套监控系统</li>
<li>寻找能满足需求的开源的监控系统</li>
</ol>
<p>从人力成本考虑，方案一是一个比较好的选择，小米在当初就是用的开源监控系统Zabbix</p>
<h3 id="阶段三："><a href="#阶段三：" class="headerlink" title="阶段三："></a>阶段三：</h3><p>机器数量：n &gt; 200<br>等公司规模继续扩大发展到非常大的规模，发展到5000台机器，每个机器假设有100个监控项，就是50W监控项，这样在mysql数据库储存方案就遇到了性能瓶颈，如果搭建多套zabbix，管理成本也会非常高昂。此时，就迫切需要根据公司的需求自己开发一套监控系统。下面就让我们思考下怎么开发一套监控系统。</p>
<h3 id="总体设计"><a href="#总体设计" class="headerlink" title="总体设计"></a>总体设计</h3><p>现在我们需要开发一套监控系统，下面就思考一下整体的架构<br>首先我们要收集数据，数据包括机器指标和业务产生的数据，所以我们需要一个agent采集端。<br>有了数据后，有两个用途：1.画趋势图  2.做告警判断<br>所以还需要两个组件，一个负责储存并展示历史数据，一个负责告警判断<br>这篇就到这里，后续文章将对三个重要组件及其拓展做更详细的讲解</p>
<p>–End–</p>
</div></article></div></section><footer><div class="paginator"><a href="/2015/09/21/ifttt-rss-evernote/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = '710leo';
var disqus_identifier = '2016/06/28/monitor-system/';
var disqus_title = '企业级监控系统设计实践（1）';
var disqus_url = 'http://blog.x2know.org/2016/06/28/monitor-system/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//710leo.disqus.com/count.js" async></script><div class="copyright"><p>© 2014 - 2016 <a href="http://blog.x2know.org">qinyening</a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-54783341-1",'auto');ga('send','pageview');</script></body></html>